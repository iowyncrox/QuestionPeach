USE task_manager


DELIMITER $$

DROP PROCEDURE get_every_task;

CREATE PROCEDURE get_every_task()
    
BEGIN

INSERT INTO TASKA SELECT task.TASK_ID, task.PARENT_TASK_ID, task.priority_nr , task.SHORT_TITLE_TX, task.SHORT_DESCRIPTION_TX,
task.LONG_DESCRIPTION_TX, task.DEADLINE_DT, task.ESTIMATED_COMPLETION_DT, task.COMPLETION_DT,
person.FIRST_NM, person.LAST_NM, task.ASSIGN_ORGANIZATION_ID FROM task INNER JOIN person ON task.RECIPIENT_PERSON_ID = person.PERSON_ID;


INSERT INTO TASKB SELECT task.TASK_ID, person.FIRST_NM, person.LAST_NM FROM task INNER JOIN person ON task.ASSIGNED_TO_PERSON_ID = person.PERSON_ID;

INSERT INTO TASKC Select task.TASK_ID, person.FIRST_NM, person.LAST_NM , CREATED_BY_USER_NM, CREATED_DTTM, LAST_UPDATED_BY_USER_NM, LAST_UPDATED_DTTM
FROM task INNER JOIN person ON task.ASSIGNED_BY_PERSON_ID = person.PERSON_ID;


INSERT INTO TASKD Select TASKA.TASK_ID, TASKA.PARENT_TASK_ID, TASKA.priority_nr , TASKA.SHORT_TITLE_TX, TASKA.SHORT_DESCRIPTION_TX,
TASKA.LONG_DESCRIPTION_TX, TASKA.DEADLINE_DT, TASKA.ESTIMATED_COMPLETION_DT, TASKA.COMPLETION_DT,
TASKA.FIRST_NM, TASKA.LAST_NM , TASKA.ASSIGN_ORGANIZATION_ID, TASKB.FIRST_NM, TASKB.LAST_NM FROM TASKA INNER JOIN TASKB
ON TASKA.TASK_ID = TASKB.TASK_ID;

INSERT INTO TASKE Select TASKD.TASK_ID, TASKD.PARENT_TASK_ID, TASKD.priority_nr , TASKD.SHORT_TITLE_TX, TASKD.SHORT_DESCRIPTION_TX,
TASKD.LONG_DESCRIPTION_TX, TASKD.DEADLINE_DT, TASKD.ESTIMATED_COMPLETION_DT, TASKD.COMPLETION_DT,
TASKD.FIRST_NM, TASKD.LAST_NM , TASKD.ASSIGN_ORGANIZATION_ID, TASKC.FIRST_NM, TASKC.LAST_NM ,
TASKC.CREATED_BY_USER_NM, TASKC.CREATED_DTTM, TASKC.LAST_UPDATED_BY_USER_NM, TASKC.LAST_UPDATED_DTTM
FROM TASKD INNER JOIN TASKC
ON TASKD.TASK_ID = TASKC.TASK_ID;
    
SELECT * FROM TASKE;
             
END $$

DELIMITER ;